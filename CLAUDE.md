# CLAUDE.md

このファイルは、このリポジトリでコードを操作する際にClaude Code (claude.ai/code)にガイダンスを提供します。

## 開発コマンド

- `npm install` - 依存関係をインストール
- `npm start` - 開発サーバーを起動 (通常はlocalhost:3000で実行)
- `npm run build` - 本番用にビルド
- `npm test` - テストを実行
- `npm test -- --testNamePattern="ComponentName"` - 特定のテストを実行

## アプリケーション アーキテクチャ

これは、シンプルな2画面アーキテクチャを持つReact + TypeScript株価分析アプリケーションです：

### 基本ナビゲーションパターン
アプリは`App.tsx`で`selectedStock`ステートによって制御される条件付きレンダリングパターンを使用：
- `selectedStock`がnullの場合：`StockList`コンポーネントを表示
- `selectedStock`に値がある場合：`StockDetail`コンポーネントを表示

### データフロー アーキテクチャ
- **StockService**: 現実的な変動を持つモック株価データを提供する集中データレイヤー
- **モックデータ戦略**: 数学関数（サイン波、ランダム変動）を使用して現実的な株価変動をシミュレート
- **リアルタイム更新**: コンポーネントは`setInterval`を使用して30秒ごとにデータを自動更新

### コンポーネントの役割
- **StockList**: 基本的な価格情報を持つ株価カードのグリッドを表示し、株式選択を処理
- **StockDetail**: 価格履歴、テクニカル分析、チャートを含む詳細ビューを表示
- **StockChart**: ツールチップと参照線を持つRecharts基盤の折れ線グラフ

### テクニカル分析エンジン
`StockService.calculateAnalysis()`メソッドは以下を実装：
- 移動平均（5日、20日、50日期間）
- 標準偏差を使用したボラティリティ計算
- 移動平均クロスオーバーに基づくトレンド検出
- すべての計算はモック履歴データでクライアント側で実行

### 型システム
`types/stock.ts`の3つの主要インターフェース：
- `StockData`: リアルタイム株価情報
- `StockPriceHistory`: OHLCV履歴データポイント
- `StockAnalysis`: テクニカル分析結果

### スタイリング アーキテクチャ
- コンポーネント固有のスタイルシートを持つCSSモジュールパターン
- CSS GridとFlexboxを使用したレスポンシブデザイン
- 価格変動の色分け（上昇は緑、下降は赤）
- グラスモーフィズム効果を持つグラデーション背景

## 主要実装詳細

- 履歴データは`MOCK_STOCKS`のベース価格を使用してアルゴリズム的に生成
- すべてのAPI呼び出しは`setTimeout`でネットワーク遅延をシミュレート
- チャートデータは表示用に日本語日付形式に変換
- 移動平均は、データポイントが不十分な場合のエッジケースを処理
- 価格フォーマットは、アプリケーション全体で一貫して小数点以下2桁を使用

## 処理シーケンス図

詳細な処理フローについては @processing-sequence.md を参照してください。